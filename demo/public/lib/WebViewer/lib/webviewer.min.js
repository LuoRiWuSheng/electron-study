(function(root,PDFTron){if(typeof exports==="object"&&typeof module==="object")module.exports=PDFTron();else if(typeof define==="function"&&define.amd)define(PDFTron);else if(typeof exports==="object")exports.PDFTron=PDFTron();else root.PDFTron=PDFTron()})(typeof self!=="undefined"?self:this,function(){var PDFTron=PDFTron||{};if(typeof console==="undefined")window.console={log:function(){},warn:function(){},error:function(){}};var Utils={extend:function(){for(var i=1;i<arguments.length;i++)for(var key in arguments[i])if(arguments[i].hasOwnProperty(key))arguments[0][key]=
arguments[i][key];return arguments[0]},createEvent:function(eventName,data){var event;try{event=new CustomEvent(eventName,{detail:data,bubbles:true,cancelable:true})}catch(e){event=document.createEvent("Event");event.initEvent(eventName,true,true);event.detail=data}return event}};if(window.PDFNet&&!PDFTron.skipPDFNetWebViewerWarning)console.warn("PDFNet.js and WebViewer.js have been included in the same context. See pdftron.com/kb_same_context for an explanation of why this could be an error in your application.");
PDFTron.WebViewer=function WebViewer(options,element){this._validateOptions(options);if(options.ui==="legacy"){options.html5Path="ui-legacy/ReaderControl.html";options.html5MobilePath="ui-legacy/MobileReaderControl.html";if(options.mobileRedirect===undefined)options.mobileRedirect=true}this.options=Utils.extend({},PDFTron.WebViewer.Options,options);if(typeof options.path!=="undefined"){var lastCharIndex=this.options.path.length-1;if(lastCharIndex>0&&this.options.path[lastCharIndex]!=="/")this.options.path+=
"/";this.options.html5Path=this.options.path+this.options.html5Path;this.options.html5MobilePath=this.options.path+this.options.html5MobilePath}if(!element)console.error("ViewerElement is not defined. This may be caused by calling the WebViewer constructor before the DOM is loaded, or an invalid selector. Please see https://www.pdftron.com/documentation/web/guides/quick-start for an example.");this.element=element;this.element.style.overflow="hidden";window.WebViewer={l:function(){return options.l},
workerTransportPromise:function(){return options.workerTransportPromise}};window.addEventListener("message",function(event){if(event.data==="requestl")event.source.postMessage({type:"responsel",value:options.l},"*")},false);if(this.options.autoCreate)this.create()};PDFTron.WebViewer.prototype={version:"5.0.0",create:function(){if(this.options.initialDoc){var docPath=this._correctRelativePath(this.options.initialDoc);docPath=encodeURIComponent(docPath);this.options.initialDoc=docPath;this._create()}else this._create()},
_create:function(){var me=this;me.rcId=((1+Math.random())*65536|0).toString(16).substring(1);if(typeof this._trigger==="undefined")this._trigger=function(type,data){var event=Utils.createEvent(type,data);this.element.dispatchEvent(event)};var viewers=this.options.type.replace(" ","").split(",");if(viewers.length<1)viewers[0]="html5";me._createViewer(viewers)},_validateOptions:function(options){for(var option in options)if(!(option in PDFTron.WebViewer.Options))console.warn(option+" is not a valid option name.");
if(options.enableRedaction&&!(options.fullAPI||options.pdftronServer))console.warn("FullAPI or WebViewer Server is needed to apply redactions")},_notSupportedMobile:function(){var notSupportedDiv=document.createElement("div");notSupportedDiv.id="webviewer-browser-unsupported";notSupportedDiv.textContent="PDF document viewing is not supported by this browser.";this.element.appendChild(notSupportedDiv)},_createViewer:function(viewers){var me=this;me.selectedType=null;var newLocation;if(this.isMobileDevice()){if(this.options.documentType&&
this.options.documentType!=="xod"&&!this._testWebAssembly()){this._notSupportedMobile();return}viewers=Array("html5Mobile");me.selectedType="html5Mobile";if(this.options.mobileRedirect){newLocation=this.options.html5MobilePath+this._getHTML5OptionsURL();window.location=newLocation;return}}var allowHTML5=false;var corsError=false;for(var i=0;i<viewers.length;i++){if(viewers[i].toLowerCase()==="html5mobile"){if(this.options.documentType&&this.options.documentType!=="xod"&&!this._testWebAssembly())continue;
allowHTML5=true;if(me._testHTML5()){if(this.options.mobileRedirect){me.selectedType="html5Mobile";newLocation=this.options.html5MobilePath+this._getHTML5OptionsURL();window.location=newLocation;return}if(this.options.xdomainProxyUrl||me.isSameOrigin(decodeURIComponent(me.options.initialDoc))||me._testCORS()){me.selectedType="html5Mobile";break}else corsError=true}}if(viewers[i].toLowerCase()==="html5"){allowHTML5=true;if(me._testHTML5()){var sameOrigin=me.isSameOrigin(decodeURIComponent(me.options.initialDoc));
if(this.options.xdomainProxyUrl||sameOrigin||me._testCORS()){me.selectedType="html5";break}else corsError=true}}}if(me.selectedType==="html5")me._createHTML5();else if(me.selectedType==="html5Mobile")me._createHTML5Mobile();else{var supportError;if(corsError)supportError="This browser does not support cross origin requests. Please configure xdomain to support CORS.";else if(allowHTML5)supportError="Please use an HTML5 compatible browser.";if(supportError){var unsupportedDiv=document.createElement("div");
unsupportedDiv.id="webviewer-browser-unsupported";unsupportedDiv.textContent=supportError;me.element.appendChild(unsupportedDiv)}}},_viewerLoaded:function(iframe){var me=this;me._trigger("ready");try{var viewerWindow=iframe.contentWindow;var outerWindow=window;outerWindow.CoreControls=outerWindow.CoreControls||{};outerWindow.CoreControls.DisplayModes=viewerWindow.CoreControls.DisplayModes;if(typeof me.options.encryption!=="undefined"){var doc=decodeURIComponent(me.options.initialDoc);var loadOptions=
{decrypt:viewerWindow.CoreControls.Encryption.decrypt,decryptOptions:me.options.encryption,documentId:me.options.documentId};viewerWindow.ControlUtils.byteRangeCheck(function(status){if(status===200)loadOptions.streaming=true;me.loadDocument(doc,loadOptions)},function(){loadOptions.streaming=true;me.loadDocument(doc,loadOptions)})}if(me.instance.docViewer.getDocument()===null)viewerWindow.$(iframe.contentDocument).on("documentLoaded",function(event){me._trigger(event.type)});else me._trigger("documentLoaded");
viewerWindow.$(iframe.contentDocument).on("displayModeChanged layoutModeChanged zoomChanged pageChanged fitModeChanged toolModeChanged printProgressChanged error",function(){var event=arguments[0];me._trigger(event.type,Array.prototype.slice.call(arguments,1))})}catch(error){console.warn("Viewer is on a different domain, API functions will not work because of cross domain permissions. See https://pdftron.com/kb_cross_origin for more information.")}},_isPDFExtension:function(extension){var result=
false;if(extension){var pdfExtensions=[".pdf",".png",".jpg","jpeg"];pdfExtensions.forEach(function(ext){if(extension===ext)result=true})}return result},_isOfficeExtension:function(extension){var result=false;if(extension){var officeExtensions=[".docx",".doc",".pptx"];officeExtensions.forEach(function(ext){if(extension===ext)result=true})}return result},_getHTML5OptionsURL:function(){if(this.selectedType==="html5"){if(this.options.html5Options)Utils.extend(this.options,this.options.html5Options)}else if(this.selectedType===
"html5Mobile")if(this.options.html5MobileOptions)Utils.extend(this.options,this.options.html5MobileOptions);var options=this.options;var url="";function acceptBackendUrl(officeEnabled,pdfEnabled){if(officeEnabled)url+=options.backendType?"&office="+options.backendType:"&office=auto";if(pdfEnabled)url+=options.backendType?"&pdf="+options.backendType:"&pdf=auto"}if(options.initialDoc)url+="#d="+options.initialDoc;var officeEnabled=false,pdfEnabled=false;var periodPosition;var extension=options.initialDoc&&
(periodPosition=options.initialDoc.lastIndexOf("."))?options.initialDoc.slice(periodPosition).toLowerCase():null;if(options.documentType==="pdf"||options.documentType==="all"||typeof options.documentType==="undefined"&&this._isPDFExtension(extension))pdfEnabled=true;if(options.documentType==="office"||options.documentType==="all"||typeof options.documentType==="undefined"&&this._isOfficeExtension(extension))officeEnabled=true;if(options.documentType)url+="&documentType="+options.documentType;if(typeof options.backendType===
"undefined")options.backendType=options.pdfBackend;acceptBackendUrl(officeEnabled,pdfEnabled);if(options.streaming)url+="&streaming="+options.streaming;if(options.externalPath){var path=this._correctRelativePath(options.externalPath);path=encodeURIComponent(path);url+="&p="+path}if(options.encryption)url+="&auto_load=false";if(options.enableAnnotations)url+="&a=1";if(options.disabledElements&&options.ui!=="legacy"){var disabledElements=encodeURIComponent(options.disabledElements.join(","));url+="&disabledElements="+
disabledElements}if(options.serverUrl){var serverUrl=this._correctRelativePath(options.serverUrl);serverUrl=encodeURIComponent(serverUrl);url+="&server_url="+serverUrl}if(options.serverUrlHeaders)url+="&serverUrlHeaders="+JSON.stringify(options.serverUrlHeaders);if(options.documentId)url+="&did="+options.documentId;if(options.css){var css=this._correctRelativePath(options.css);css=encodeURIComponent(css);url+="&css="+css}if(options.config){var config=this._correctRelativePath(options.config);config=
encodeURIComponent(config);url+="&config="+config}if(options.disableI18n&&options.ui!=="legacy")url+="&disableI18n=1";if(options.enableOfflineMode)url+="&offline=1";if(options.startOffline)url+="&startOffline=1";if(options.enableReadOnlyMode)url+="&readonly=1";if(options.hideAnnotationPanel)url+="&hideAnnotationPanel=1";if(typeof options.annotationUser!=="undefined")url+="&user="+options.annotationUser;if(typeof options.annotationAdmin!=="undefined")url+="&admin="+(options.annotationAdmin?1:0);if(typeof options.custom!==
"undefined")url+="&custom="+encodeURIComponent(options.custom);if(typeof options.showLocalFilePicker!=="undefined")url+="&filepicker="+(options.showLocalFilePicker?1:0);if(typeof options.preloadPDFWorker!=="undefined")url+="&preloadWorker="+(options.preloadPDFWorker?1:0);if(typeof options.fullAPI!=="undefined")url+="&pdfnet="+(options.fullAPI?1:0);if(typeof options.enableRedaction!=="undefined")url+="&enableRedaction="+(options.enableRedaction?1:0);if(typeof options.enableMeasurement!=="undefined")url+=
"&enableMeasurement="+(options.enableMeasurement?1:0);if(typeof options.showToolbarControl!=="undefined")url+="&toolbar="+(options.showToolbarControl?"true":"false");if(typeof options.showPageHistoryButtons!=="undefined")url+="&pageHistory="+(options.showPageHistoryButtons?1:0);if(typeof options.xdomainProxyUrl!=="undefined"){var urls;if(typeof options.xdomainProxyUrl==="string")urls={url:options.xdomainProxyUrl};else urls=options.xdomainProxyUrl;url+="&xdomain_urls="+encodeURIComponent(JSON.stringify(urls))}if(options.azureWorkaround)url+=
"&azureWorkaround=1";if(!options.useDownloader)url+="&useDownloader=0";if(options.disableWebsockets)url+="&disableWebsockets=1";if(options.subzero)url+="&subzero=1";if(typeof options.workerTransportPromise!=="undefined")url+="&useSharedWorker="+(options.workerTransportPromise?"true":"false");if(typeof options.pdftronServer!=="undefined"&&options.pdftronServer)url+="&pdftronServer="+encodeURIComponent(options.pdftronServer);if(url.length>0&&url[0]==="&")url="#"+url.slice(1);return url},_createHTML5:function(){var me=
this;var iframeSource=this.options.html5Path+this._getHTML5OptionsURL();var rcFrame=document.createElement("iframe");rcFrame.id=this.rcId;rcFrame.src=iframeSource;rcFrame.title="webviewer";rcFrame.frameBorder=0;rcFrame.width="100%";rcFrame.height="100%";rcFrame.setAttribute("allowfullscreen",true);rcFrame.setAttribute("webkitallowfullscreen",true);rcFrame.setAttribute("mozallowfullscreen",true);if(this.options.backgroundColor)rcFrame.setAttribute("data-bgcolor",this.options.backgroundColor);if(this.options.assetPath)rcFrame.setAttribute("data-assetpath",
encodeURIComponent(this.options.assetPath));rcFrame.addEventListener("load",function(){try{me.instance=this.contentWindow.readerControl;var iframe=this;if(typeof me.instance==="undefined")this.contentWindow.$(this.contentDocument).on("viewerLoaded",function(){me.instance=iframe.contentWindow.readerControl;me._viewerLoaded(iframe)});else me._viewerLoaded(iframe)}catch(error){me._viewerLoaded(iframe)}});this.element.appendChild(rcFrame)},_createHTML5Mobile:function(){var me=this;var iframeSource=this.options.html5MobilePath+
this._getHTML5OptionsURL();var rcFrame=document.createElement("iframe");rcFrame.id=this.rcId;rcFrame.src=iframeSource;rcFrame.frameborder=0;if(this.options.assetPath)rcFrame.setAttribute("data-assetpath",encodeURIComponent(this.options.assetPath));rcFrame.style.width="100%";rcFrame.style.height="100%";rcFrame.addEventListener("load",function(){try{me.instance=this.contentWindow.readerControl;var iframe=this;if(typeof me.instance==="undefined")this.contentWindow.$(this.contentDocument).bind("viewerLoaded",
function(){me.instance=iframe.contentWindow.readerControl;me._viewerLoaded(iframe)});else me._viewerLoaded(iframe)}catch(error){me._viewerLoaded(iframe)}});this.element.appendChild(rcFrame)},getInstance:function(){if(!this.instance)console.error("The viewer instance is not defined yet. Try calling getInstance() in the ready event listener, or check https://www.pdftron.com/documentation/web/guides/ui/apis for a detailed example.");return this.instance},getSideWindowVisibility:function(){return this.getInstance().getShowSideWindow()},
setSideWindowVisibility:function(value){this.getInstance().setShowSideWindow(value)},getShowSideWindow:function(){return this.getSideWindowVisibility()},setShowSideWindow:function(value){this.setSideWindowVisibility(value)},getToolbarVisibility:function(){console.warn("Unsupported method getToolbarVisibility")},setToolbarVisibility:function(isVisible){this.getInstance().setToolbarVisibility(isVisible)},getCurrentPageNumber:function(){return this.getInstance().getCurrentPageNumber()},setCurrentPageNumber:function(pageNumber){this.getInstance().setCurrentPageNumber(pageNumber)},
getPageCount:function(){return this.getInstance().getPageCount()},getZoomLevel:function(){return this.getInstance().getZoomLevel()},setZoomLevel:function(zoomLevel){this.getInstance().setZoomLevel(zoomLevel)},rotateClockwise:function(){this.getInstance().rotateClockwise()},rotateCounterClockwise:function(){this.getInstance().rotateCounterClockwise()},getLayoutMode:function(){var layoutMode=this.getInstance().getLayoutMode();var displayModes=CoreControls.DisplayModes;if(layoutMode===displayModes.Single)return PDFTron.WebViewer.LayoutMode.Single;
else if(layoutMode===displayModes.Continuous)return PDFTron.WebViewer.LayoutMode.Continuous;else if(layoutMode===displayModes.Facing)return PDFTron.WebViewer.LayoutMode.Facing;else if(layoutMode===displayModes.FacingContinuous)return PDFTron.WebViewer.LayoutMode.FacingContinuous;else if(layoutMode===displayModes.Cover)return PDFTron.WebViewer.LayoutMode.FacingCoverContinuous;else if(layoutMode===displayModes.CoverFacing)return PDFTron.WebViewer.LayoutMode.FacingCover;return undefined},setLayoutMode:function(layoutMode){var displayModes=
CoreControls.DisplayModes;var displayMode=displayModes.Continuous;if(layoutMode===PDFTron.WebViewer.LayoutMode.Single)displayMode=displayModes.Single;else if(layoutMode===PDFTron.WebViewer.LayoutMode.Continuous)displayMode=displayModes.Continuous;else if(layoutMode===PDFTron.WebViewer.LayoutMode.Facing)displayMode=displayModes.Facing;else if(layoutMode===PDFTron.WebViewer.LayoutMode.FacingContinuous)displayMode=displayModes.FacingContinuous;else if(layoutMode===PDFTron.WebViewer.LayoutMode.FacingCover)displayMode=
displayModes.CoverFacing;else if(layoutMode===PDFTron.WebViewer.LayoutMode.FacingCoverContinuous)displayMode=displayModes.Cover;this.getInstance().setLayoutMode(displayMode)},getToolMode:function(){return this.getInstance().getToolMode()},setToolMode:function(toolMode){this.getInstance().setToolMode(toolMode)},fitWidth:function(){var docViewer=this.getInstance().docViewer;docViewer.setFitMode(docViewer.FitMode.FitWidth)},fitHeight:function(){},fitPage:function(){var docViewer=this.getInstance().docViewer;
docViewer.setFitMode(docViewer.FitMode.FitPage)},getFitMode:function(){var fitMode=this.getInstance().getFitMode();var FitModeEnums=this.getInstance().docViewer.FitMode;switch(fitMode){case FitModeEnums.FitWidth:return PDFTron.WebViewer.FitMode.FitWidth;case FitModeEnums.FitHeight:return PDFTron.WebViewer.FitMode.FitHeight;case FitModeEnums.FitPage:return PDFTron.WebViewer.FitMode.FitPage;case FitModeEnums.Zoom:return PDFTron.WebViewer.FitMode.Zoom;default:console.warn("Unsupported fit mode")}},setFitMode:function(fitMode){if(fitMode===
PDFTron.WebViewer.FitMode.FitWidth)this.fitWidth();else if(fitMode===PDFTron.WebViewer.FitMode.FitHeight)this.fitHeight();else if(fitMode===PDFTron.WebViewer.FitMode.FitPage)this.fitPage();else if(fitMode===PDFTron.WebViewer.FitMode.Zoom)this.zoom();else console.warn("Unsupported fit mode: "+fitMode)},zoom:function(){var docViewer=this.getInstance().docViewer;docViewer.setFitMode(docViewer.FitMode.Zoom)},goToFirstPage:function(){this.getInstance().goToFirstPage()},goToLastPage:function(){this.getInstance().goToLastPage()},
goToNextPage:function(){this.getInstance().goToNextPage()},goToPrevPage:function(){this.getInstance().goToPrevPage()},loadDocument:function(url,options){var existingLoadOptions={streaming:this.options.streaming};var loadOptions=Utils.extend({},existingLoadOptions,options);if(typeof loadOptions.documentId!=="undefined")this.getInstance().docId=loadOptions.documentId;this.getInstance().loadDocument(this._correctRelativePath(url),loadOptions)},searchText:function(pattern,searchModes){var mode=0;var modes=
searchModes;if(typeof modes==="string")modes=searchModes.split(",");if(typeof modes!=="undefined")for(var i=0;i<modes.length;i++)if(modes[i]==="CaseSensitive")mode+=1;else if(modes[i]==="WholeWord")mode+=2;else if(modes[i]==="SearchUp")mode+=4;else if(modes[i]==="PageStop")mode+=8;else if(modes[i]==="ProvideQuads")mode+=16;else if(modes[i]==="AmbientString")mode+=32;if(typeof searchModes==="undefined")this.getInstance().searchText(pattern);else this.getInstance().searchText(pattern,mode)},setAnnotationUser:function(username){this.getInstance().setAnnotationUser(username)},
setAdminUser:function(isAdminUser){this.getInstance().setAdminUser(isAdminUser)},setReadOnly:function(isReadOnly){this.getInstance().setReadOnly(isReadOnly)},downloadXodDocument:function(){if(this.documentType==="xod"){var url=decodeURIComponent(this.options.initialDoc);window.open(url)}else console.warn("Unsupported method for this document type")},startPrintJob:function(pages){if(this.selectedType==="html5")this.getInstance().startPrintJob(pages);else console.warn("Unsupported method startPrintJob")},
endPrintJob:function(){if(this.selectedType==="html5")this.getInstance().endPrintJob();else console.warn("Unsupported method endPrintJob")},getViewerType:function(){return this.selectedType},_correctRelativePath:function(path){if(typeof path!=="string")return path;var curdir=window.location.pathname.substr(0,window.location.pathname.lastIndexOf("/"));var pattern=/^(https?:\/\/|file:\/\/|cid:\/\/|ms-appdata:\/\/|ms-appx-web:\/\/|\/|blob:|%2F|filesystem:)/i;return pattern.test(path)?path:curdir+"/"+
path},_testHTML5:function(){try{var c=document.createElement("canvas");return c&&c.getContext("2d")}catch(e){return false}},_testWebAssembly:function(){return!!(window.WebAssembly&&window.WebAssembly.validate)},_supports:function(type){if(type===this.selectedType)return true;for(var i=1;i<arguments.length;i++)if(arguments[i]===this.selectedType)return true;return false},_testCORS:function(){return"XMLHttpRequest"in window&&"withCredentials"in new XMLHttpRequest},isIE:function(){var ua=navigator.userAgent.toLowerCase();
var match=/(msie) ([\w.]+)/.exec(ua)||/(trident)(?:.*? rv:([\w.]+)|)/.exec(ua);return match?parseInt(match[2],10):match},isMobileDevice:function(){return!this.isIE()&&(this.scrollbarWidth()===0&&navigator.userAgent.match(/Edge/i)||navigator.userAgent.match(/Android/i)||navigator.userAgent.match(/webOS/i)||navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/Touch/i)||navigator.userAgent.match(/IEMobile/i)||navigator.userAgent.match(/Silk/i))},
scrollbarWidth:function(){var scrollDiv=document.createElement("div");scrollDiv.style.cssText="width:100px;height:100px;overflow:scroll !important;position:absolute;top:-9999px";document.body.appendChild(scrollDiv);var result=scrollDiv.offsetWidth-scrollDiv.clientWidth;document.body.removeChild(scrollDiv);return result},isSameOrigin:function(url){var loc=window.location;var a=document.createElement("a");a.href=url;if(a.host==="")a.href=a.href;var locPort=window.location.port;var aPort=a.port;if(a.protocol===
"http:"){aPort=aPort||"80";locPort=locPort||"80"}else if(a.protocol==="https:"){aPort=aPort||"443";locPort=locPort||"443"}return a.hostname===loc.hostname&&a.protocol===loc.protocol&&aPort===locPort},runInIframe:function(func){var iframeWindow=this.element.querySelector("iframe").contentWindow;var me=this;var callFunc=function(){me.element.removeEventListener("ready",callFunc);func(iframeWindow,me.getInstance(),iframeWindow.$)};if(this.getInstance())setTimeout(callFunc,0);else this.element.addEventListener("ready",
callFunc)}};PDFTron.WebViewer.Options={initialDoc:undefined,annotationAdmin:undefined,annotationUser:undefined,assetPath:undefined,autoCreate:true,azureWorkaround:false,backgroundColor:undefined,css:undefined,config:undefined,custom:undefined,documentId:undefined,documentType:undefined,enableAnnotations:true,disableI18n:false,disabledElements:undefined,disableWebsockets:false,enableOfflineMode:false,enableReadOnlyMode:false,enableRedaction:false,enableMeasurement:false,encryption:undefined,externalPath:undefined,
hideAnnotationPanel:false,html5MobileOptions:{},html5MobilePath:"./ui/build/index.html",html5Options:{},html5Path:"./ui/build/index.html",l:undefined,mobileRedirect:false,path:"",pdfBackend:undefined,pdftronServer:undefined,fullAPI:false,preloadPDFWorker:true,serverUrl:undefined,serverUrlHeaders:undefined,showLocalFilePicker:false,showPageHistoryButtons:true,showToolbarControl:undefined,startOffline:false,streaming:false,subzero:true,type:"html5,html5Mobile",useDownloader:true,workerTransportPromise:undefined,
xdomainProxyUrl:undefined,ui:undefined};return PDFTron});
