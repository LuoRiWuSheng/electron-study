function _asyncToGenerator(t){return function(){var a=t.apply(this,arguments);return new Promise(function(i,s){return function e(t,n){try{var r=a[t](n),o=r.value}catch(t){return void s(t)}if(!r.done)return Promise.resolve(o).then(function(t){e("next",t)},function(t){e("throw",t)});i(o)}("next")})}}!function(t){"use strict";var f,c=Object.prototype.hasOwnProperty,e="function"==typeof Symbol?Symbol:{},o=e.iterator||"@@iterator",n=e.toStringTag||"@@toStringTag",r="object"==typeof module,i=t.regeneratorRuntime;if(i)r&&(module.exports=i);else{(i=t.regeneratorRuntime=r?module.exports:{}).wrap=a;var p="suspendedStart",h="suspendedYield",d="executing",g="completed",y={},s=u.prototype=v.prototype;l.prototype=s.constructor=u,u.constructor=l,u[n]=l.displayName="GeneratorFunction",i.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===l||"GeneratorFunction"===(e.displayName||e.name))},i.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,u):(t.__proto__=u,n in t||(t[n]="GeneratorFunction")),t.prototype=Object.create(s),t},i.awrap=function(t){return new w(t)},x(P.prototype),i.async=function(t,e,n,r){var o=new P(a(t,e,n,r));return i.isGeneratorFunction(e)?o:o.next().then(function(t){return t.done?t.value:o.next()})},x(s),s[o]=function(){return this},s[n]="Generator",s.toString=function(){return"[object Generator]"},i.keys=function(n){var r=[];for(var t in n)r.push(t);return r.reverse(),function t(){for(;r.length;){var e=r.pop();if(e in n)return t.value=e,t.done=!1,t}return t.done=!0,t}},i.values=b,S.prototype={constructor:S,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=f,this.done=!1,this.delegate=null,this.tryEntries.forEach(D),!t)for(var e in this)"t"===e.charAt(0)&&c.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=f)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(n){if(this.done)throw n;var r=this;function t(t,e){return i.type="throw",i.arg=n,r.next=t,!!e}for(var e=this.tryEntries.length-1;0<=e;--e){var o=this.tryEntries[e],i=o.completion;if("root"===o.tryLoc)return t("end");if(o.tryLoc<=this.prev){var s=c.call(o,"catchLoc"),a=c.call(o,"finallyLoc");if(s&&a){if(this.prev<o.catchLoc)return t(o.catchLoc,!0);if(this.prev<o.finallyLoc)return t(o.finallyLoc)}else if(s){if(this.prev<o.catchLoc)return t(o.catchLoc,!0)}else{if(!a)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return t(o.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;0<=n;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&c.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var o=r;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var i=o?o.completion:{};return i.type=t,i.arg=e,o?this.next=o.finallyLoc:this.complete(i),y},complete:function(t,e){if("throw"===t.type)throw t.arg;"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=t.arg,this.next="end"):"normal"===t.type&&e&&(this.next=e)},finish:function(t){for(var e=this.tryEntries.length-1;0<=e;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),D(n),y}},catch:function(t){for(var e=this.tryEntries.length-1;0<=e;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var o=r.arg;D(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:b(t),resultName:e,nextLoc:n},y}}}function a(t,e,n,r){var s,a,c,l,o=e&&e.prototype instanceof v?e:v,i=Object.create(o.prototype),u=new S(r||[]);return i._invoke=(s=t,a=n,c=u,l=p,function(t,e){if(l===d)throw new Error("Generator is already running");if(l===g){if("throw"===t)throw e;return _()}for(;;){var n=c.delegate;if(n){if("return"===t||"throw"===t&&n.iterator[t]===f){c.delegate=null;var r=n.iterator.return;if(r){var o=m(r,n.iterator,e);if("throw"===o.type){t="throw",e=o.arg;continue}}if("return"===t)continue}var o=m(n.iterator[t],n.iterator,e);if("throw"===o.type){c.delegate=null,t="throw",e=o.arg;continue}t="next",e=f;var i=o.arg;if(!i.done)return l=h,i;c[n.resultName]=i.value,c.next=n.nextLoc,c.delegate=null}if("next"===t)c.sent=c._sent=e;else if("throw"===t){if(l===p)throw l=g,e;c.dispatchException(e)&&(t="next",e=f)}else"return"===t&&c.abrupt("return",e);l=d;var o=m(s,a,c);if("normal"===o.type){l=c.done?g:h;var i={value:o.arg,done:c.done};if(o.arg!==y)return i;c.delegate&&"next"===t&&(e=f)}else"throw"===o.type&&(l=g,t="throw",e=o.arg)}}),i}function m(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}function v(){}function l(){}function u(){}function x(t){["next","throw","return"].forEach(function(e){t[e]=function(t){return this._invoke(e,t)}})}function w(t){this.arg=t}function P(a){function c(t,e,n,r){var o=m(a[t],a,e);if("throw"!==o.type){var i=o.arg,s=i.value;return s instanceof w?Promise.resolve(s.arg).then(function(t){c("next",t,n,r)},function(t){c("throw",t,n,r)}):Promise.resolve(s).then(function(t){i.value=t,n(i)},r)}r(o.arg)}var e;"object"==typeof process&&process.domain&&(c=process.domain.bind(c)),this._invoke=function(n,r){function t(){return new Promise(function(t,e){c(n,r,t,e)})}return e=e?e.then(t,t):t()}}function F(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function D(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function S(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(F,this),this.reset(!0)}function b(e){if(e){var t=e[o];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,r=function t(){for(;++n<e.length;)if(c.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=f,t.done=!0,t};return r.next=r}}return{next:_}}function _(){return{value:f,done:!0}}}("object"==typeof global?global:"object"==typeof window?window:"object"==typeof self?self:this),function(t){"use strict";window.runEncTest=function(){var t,e=(t=_asyncToGenerator(regeneratorRuntime.mark(function t(){var e,n,r,o,i,s,a,c,l,u,f,p,h,d,g,y,m,v,x,w,P,F,D,S,b;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return console.log("Beginning Test"),e=0,n="../TestFiles/",r=null,t.prev=4,console.log("Running Sample 1"),!1,t.next=9,PDFNet.PDFDoc.createFromURL(n+"fish.pdf");case 9:return(r=t.sent).initSecurityHandler(),r.lock(),!0,console.log("PDFNet and PDF document initialized and locked"),!0,console.log("Replacing the content stream, use Flate compression..."),t.next=19,r.getTrailer();case 19:return o=t.sent,t.next=22,o.get("Root");case 22:return i=t.sent,t.next=25,i.value();case 25:return s=t.sent,t.next=28,s.get("Pages");case 28:return a=t.sent,t.next=31,a.value();case 31:return c=t.sent,t.next=34,c.get("Kids");case 34:return l=t.sent,t.next=37,l.value();case 37:return u=t.sent,t.next=40,u.getAt(0);case 40:return f=t.sent,t.next=43,PDFNet.Filter.createURLFilter(n+"my_stream.txt");case 43:return p=t.sent,t.next=46,PDFNet.FilterReader.create(p);case 46:return h=t.sent,d=new PDFNet.Filter("0"),t.next=50,PDFNet.Filter.createFlateEncode(d);case 50:return g=t.sent,t.next=53,r.createIndirectStreamFromFilter(h,g);case 53:return y=t.sent,t.next=56,f.put("Contents",y);case 56:return t.next=58,PDFNet.SecurityHandler.createDefault();case 58:return(m=t.sent).changeUserPasswordUString("test"),console.log("Setting password to 'test'"),m.setPermission(PDFNet.SecurityHandler.Permission.e_print,!1),m.setPermission(PDFNet.SecurityHandler.Permission.e_extract_content,!0),r.setSecurityHandler(m),console.log("Saving modified file..."),t.next=67,r.saveMemoryBuffer(PDFNet.SDFDoc.SaveOptions.e_linearized);case 67:v=t.sent,saveBufferAsPDFDoc(v,"secured.pdf"),t.next=76;break;case 71:t.prev=71,t.t0=t.catch(4),console.log(t.t0),console.log(t.t0.stack),e=1;case 76:return t.prev=76,console.log("Running Sample 2"),x=r,t.next=81,x.initSecurityHandler();case 81:if(t.sent){t.next=105;break}w=!1,console.log("The password has been set to : 'test'"),P=["password","testy","test"],F=0;case 86:if(F<P.length)return D=P[F],console.log("Trying password candidate: '"+D+"'"),t.next=91,x.initStdSecurityHandlerUString(D);t.next=101;break;case 91:if(t.sent)return w=!0,console.log("The password is correct"),t.abrupt("break",101);t.next=97;break;case 97:console.log("The password is incorrect.");case 98:F++,t.next=86;break;case 101:if(w){t.next=105;break}return console.log("Document authentication error..."),e=1,t.abrupt("return",e);case 105:return x.lock(),console.log("PDF document initialized and locked"),t.next=109,x.getSecurityHandler();case 109:return S=t.sent,t.t1=console,t.next=113,S.isUserPasswordRequired();case 113:return t.t2=t.sent,t.t3="Document Open Password: "+t.t2,t.t1.log.call(t.t1,t.t3),t.t4=console,t.next=119,S.isMasterPasswordRequired();case 119:return t.t5=t.sent,t.t6="Permissions Password: "+t.t5,t.t4.log.call(t.t4,t.t6),console.log("Permissions: "),t.t7=console,t.next=126,S.getPermission(PDFNet.SecurityHandler.Permission.e_owner);case 126:return t.t8=t.sent,t.t9="\tHas 'owner' permissions: "+t.t8,t.t7.log.call(t.t7,t.t9),t.t10=console,t.next=132,S.getPermission(PDFNet.SecurityHandler.Permission.e_doc_open);case 132:return t.t11=t.sent,t.t12="\tOpen and decrypt the document: "+t.t11,t.t10.log.call(t.t10,t.t12),t.t13=console,t.next=138,S.getPermission(PDFNet.SecurityHandler.Permission.e_extract_content);case 138:return t.t14=t.sent,t.t15="\tAllow content extraction: "+t.t14,t.t13.log.call(t.t13,t.t15),t.t16=console,t.next=144,S.getPermission(PDFNet.SecurityHandler.Permission.e_doc_modify);case 144:return t.t17=t.sent,t.t18="\tAllow full document editing: "+t.t17,t.t16.log.call(t.t16,t.t18),t.t19=console,t.next=150,S.getPermission(PDFNet.SecurityHandler.Permission.e_print);case 150:return t.t20=t.sent,t.t21="\tAllow printing: "+t.t20,t.t19.log.call(t.t19,t.t21),t.t22=console,t.next=156,S.getPermission(PDFNet.SecurityHandler.Permission.e_print_high);case 156:return t.t23=t.sent,t.t24="\tAllow high resolution printing: "+t.t23,t.t22.log.call(t.t22,t.t24),t.t25=console,t.next=162,S.getPermission(PDFNet.SecurityHandler.Permission.e_mod_annot);case 162:return t.t26=t.sent,t.t27="\tAllow annotation editing: "+t.t26,t.t25.log.call(t.t25,t.t27),t.t28=console,t.next=168,S.getPermission(PDFNet.SecurityHandler.Permission.e_fill_forms);case 168:return t.t29=t.sent,t.t30="\tAllow form fill: "+t.t29,t.t28.log.call(t.t28,t.t30),t.t31=console,t.next=174,S.getPermission(PDFNet.SecurityHandler.Permission.e_access_support);case 174:return t.t32=t.sent,t.t33="\tAllow content extraction for accessibility: "+t.t32,t.t31.log.call(t.t31,t.t33),t.t34=console,t.next=180,S.getPermission(PDFNet.SecurityHandler.Permission.e_assemble_doc);case 180:return t.t35=t.sent,t.t36="\tAllow document assembly: "+t.t35,t.t34.log.call(t.t34,t.t36),x.removeSecurity(),t.next=186,x.saveMemoryBuffer(PDFNet.SDFDoc.SaveOptions.e_linearized);case 186:b=t.sent,saveBufferAsPDFDoc(b,"not_secured.pdf"),console.log("done"),t.next=195;break;case 191:t.prev=191,t.t37=t.catch(76),console.log(t.t37.stack),e=1;case 195:return t.abrupt("return",e);case 196:case"end":return t.stop()}},t,void 0,[[4,71],[76,191]])})),function(){return t.apply(this,arguments)});PDFNet.runWithCleanup(e,window.sampleL)}}();